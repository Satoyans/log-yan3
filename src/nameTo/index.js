"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.xuToName = exports.nameToPlayer = exports.nameToXu = exports.niToName = exports.nameToNi = void 0;
const event_1 = require("bdsx/event");
const packetids_1 = require("bdsx/bds/packetids");
exports.nameToNi = new Map();
exports.niToName = new Map();
exports.nameToXu = new Map();
exports.nameToPlayer = new Map();
exports.xuToName = new Map();
event_1.events.playerLeft.on((ev) => {
    exports.xuToName.delete(ev.player.getXuid());
    exports.xuToName.delete(ev.player.getNameTag());
});
event_1.events.packetAfter(packetids_1.MinecraftPacketIds.Login).on((ptr, networkIdentifier, _packetId) => {
    const ip = networkIdentifier.getAddress();
    const connreq = ptr.connreq;
    if (connreq === null)
        return;
    const cert = connreq.cert;
    const xuid = cert.getXuid();
    const username = cert.getId();
    exports.nameToNi.set(username, networkIdentifier);
    exports.niToName.set(networkIdentifier, username);
    exports.nameToXu.set(username, xuid);
});
event_1.events.playerJoin.on(ev => {
    if (ev.isSimulated)
        return;
    var name = ev.player.getName();
    exports.nameToPlayer.set(name, ev.player);
    exports.xuToName.set(ev.player.getXuid(), ev.player.getNameTag());
    exports.nameToPlayer.set(ev.player.getNameTag(), ev.player);
});
event_1.events.packetAfter(packetids_1.MinecraftPacketIds.Disconnect).on((_pkt, networkIdentifier, _pktId) => {
    const name = exports.niToName.get(networkIdentifier);
    const player = exports.nameToPlayer.get(name);
    exports.nameToNi.delete(name);
    exports.niToName.delete(networkIdentifier);
    exports.nameToXu.delete(name);
    exports.nameToPlayer.delete(name);
    exports.xuToName.delete(player.getXuid());
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxzQ0FBb0M7QUFDcEMsa0RBQXdEO0FBSTNDLFFBQUEsUUFBUSxHQUFHLElBQUksR0FBRyxFQUE2QixDQUFDO0FBQ2hELFFBQUEsUUFBUSxHQUFHLElBQUksR0FBRyxFQUE2QixDQUFDO0FBQ2hELFFBQUEsUUFBUSxHQUFHLElBQUksR0FBRyxFQUFrQixDQUFDO0FBQ3JDLFFBQUEsWUFBWSxHQUFHLElBQUksR0FBRyxFQUFrQixDQUFDO0FBQ3pDLFFBQUEsUUFBUSxHQUFHLElBQUksR0FBRyxFQUFrQixDQUFDO0FBR2xELGNBQU0sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUU7SUFDeEIsZ0JBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQ3JDLGdCQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQztBQUM1QyxDQUFDLENBQUMsQ0FBQTtBQUVGLGNBQU0sQ0FBQyxXQUFXLENBQUMsOEJBQWtCLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxFQUFFO0lBQ2xGLE1BQU0sRUFBRSxHQUFHLGlCQUFpQixDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQzFDLE1BQU0sT0FBTyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUM7SUFDNUIsSUFBSSxPQUFPLEtBQUssSUFBSTtRQUFFLE9BQU87SUFDN0IsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztJQUMxQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDNUIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQzlCLGdCQUFRLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO0lBQzFDLGdCQUFRLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzFDLGdCQUFRLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUNqQyxDQUFDLENBQUMsQ0FBQztBQUVILGNBQU0sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQSxFQUFFO0lBQ3JCLElBQUksRUFBRSxDQUFDLFdBQVc7UUFBRSxPQUFPO0lBQzNCLElBQUksSUFBSSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDL0Isb0JBQVksQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNqQyxnQkFBUSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQztJQUMxRCxvQkFBWSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN4RCxDQUFDLENBQUMsQ0FBQztBQUNILGNBQU0sQ0FBQyxXQUFXLENBQUMsOEJBQWtCLENBQUMsVUFBVSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFDLGlCQUFpQixFQUFDLE1BQU0sRUFBQyxFQUFFO0lBQ2xGLE1BQU0sSUFBSSxHQUFHLGdCQUFRLENBQUMsR0FBRyxDQUFDLGlCQUFpQixDQUFFLENBQUM7SUFDOUMsTUFBTSxNQUFNLEdBQUcsb0JBQVksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFFLENBQUM7SUFDdkMsZ0JBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEIsZ0JBQVEsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQztJQUNuQyxnQkFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN0QixvQkFBWSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMxQixnQkFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztBQUN0QyxDQUFDLENBQUMsQ0FBQyJ9